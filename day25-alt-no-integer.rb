inputs = File.foreach('./input/day25-input.txt').map(&:chomp)

$adder = {
  '-==' => '-0',  '0==' => '-1',  '1==' => '-2',
  '-=-' => '-1',  '0=-' => '-2',  '1=-' => '0=',
  '-=0' => '-2',  '0=0' => '0=',  '1=0' => '0-',
  '-=1' => '0=',  '0=1' => '0-',  '1=1' => '00',
  '-=2' => '0-',  '0=2' => '00',  '1=2' => '01',

  '--=' => '-1',  '0-=' => '-2',  '1-=' => '0=',
  '---' => '-2',  '0--' => '0=',  '1--' => '0-',
  '--0' => '0=',  '0-0' => '0-',  '1-0' => '00',
  '--1' => '0-',  '0-1' => '00',  '1-1' => '01',
  '--2' => '00',  '0-2' => '01',  '1-2' => '02',

  '-0=' => '-2',  '00=' => '0=',  '10=' => '0-',
  '-0-' => '0=',  '00-' => '0-',  '10-' => '00',
  '-00' => '0-',  '000' => '00',  '100' => '01',
  '-01' => '00',  '001' => '01',  '101' => '02',
  '-02' => '01',  '002' => '02',  '102' => '1=',

  '-1=' => '0=',  '01=' => '0-',  '11=' => '00',
  '-1-' => '0-',  '01-' => '00',  '11-' => '01',
  '-10' => '00',  '010' => '01',  '110' => '02',
  '-11' => '01',  '011' => '02',  '111' => '1=',
  '-12' => '02',  '012' => '1=',  '112' => '1-',

  '-2=' => '0-',  '02=' => '00',  '12=' => '01',
  '-2-' => '00',  '02-' => '01',  '12-' => '02',
  '-20' => '01',  '020' => '02',  '120' => '1=',
  '-21' => '02',  '021' => '1=',  '121' => '1-',
  '-22' => '1=',  '022' => '1-',  '122' => '10',
}

def add_snafu(s1, s2)
  s1 = s1.split('')
  s2 = s2.split('')
  sum = ''
  carry = '0'
  while !s1.empty? || !s2.empty? || carry != '0'
    carry, value = $adder.fetch(carry + (s1.pop || '0') + (s2.pop || '0')).split('')
    sum << value
  end
  sum.reverse
end

sum = ''
inputs.each do |snafu|
  sum = add_snafu(sum, snafu)
end
puts sum